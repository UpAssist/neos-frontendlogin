privilegeTargets:

  'Neos\Flow\Security\Authorization\Privilege\Method\MethodPrivilege':
    'UpAssist.Neos.FrontendLogin:LoginForm':
      matcher: 'within(Neos\Flow\Security\Authentication\Controller\AbstractAuthenticationController) || method(UpAssist\Neos\FrontendLogin\Controller\LogingController->(?!initialize).*Action())'
    'UpAssist.Neos.FrontendLogin:RegistrationForm':
      matcher: 'method(UpAssist\Neos\FrontendLogin\Controller\UserController->(new|create)Action())'
    'UpAssist.Neos.FrontendLogin:UserProfile':
      matcher: 'method(UpAssist\Neos\FrontendLogin\Controller\UserController->(show|update)Action())'
    'UpAssist.Neos.FrontendLogin:UserIndex':
      matcher: 'method(UpAssist\Neos\FrontendLogin\Controller\UserController->(index)Action())'
    'UpAssist.Neos.FrontendLogin:CanDeleteUsers':
      matcher: 'method(UpAssist\Neos\FrontendLogin\Controller\UserController->(delete)Action())'
    'UpAssist.Neos.FrontendLogin:CanAdministerUsers':
      matcher: 'method(UpAssist\Neos\FrontendLogin\Controller\Module\UsersController->(index|show|new|create|edit|update|delete|newElectronicAddress|createElectronicAddress|deleteElectronicAddress|editAccount|updateAccount)Action())'

  'UpAssist\Neos\FrontendLogin\Security\Authorization\Privilege\Node\ReadNodePrivilege':

    'UpAssist.Neos.FrontendLogin:RestrictNode':
      matcher: 'nodePropertyIs("restrictNode", true) || parentNodePropertyIs("restrictNode", true)'

roles:

  'Neos.Flow:Everybody':
    privileges:
      -
        privilegeTarget: 'UpAssist.Neos.FrontendLogin:LoginForm'
        permission: GRANT
      -
        privilegeTarget: 'UpAssist.Neos.FrontendLogin:RegistrationForm'
        permission: GRANT

  'UpAssist.Neos.FrontendLogin:User':
    privileges:
      -
        privilegeTarget: 'UpAssist.Neos.FrontendLogin:UserProfile'
        permission: GRANT
      -
        # Grant "frontend users" access to Nodes with property "restricted" == true
        privilegeTarget: 'UpAssist.Neos.FrontendLogin:RestrictNode'
        permission: GRANT

  'Neos.Neos:Editor':
    privileges:
      -
        privilegeTarget: 'UpAssist.Neos.FrontendLogin:UserProfile'
        permission: GRANT
      -
        privilegeTarget: 'UpAssist.Neos.FrontendLogin:UserIndex'
        permission: GRANT
      -
        privilegeTarget: 'UpAssist.Neos.FrontendLogin:CanDeleteUsers'
        permission: GRANT
      -
        privilegeTarget: 'UpAssist.Neos.FrontendLogin:CanAdministerUsers'
        permission: GRANT
      -
        # Grant "frontend users" access to Nodes with property "restricted" == true
        privilegeTarget: 'UpAssist.Neos.FrontendLogin:RestrictNode'
        permission: GRANT
